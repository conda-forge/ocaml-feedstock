# Variant configuration for OCaml feedstock multi-output recipe

# C compiler configuration
# Note: On Unix, c_compiler defaults come from global conda-forge config
# We explicitly set them here for cross-compiler package name generation
c_compiler:
  - if: linux
    then:
      - gcc
  - if: osx
    then:
      - clang
  - if: not unix
    then:
      - gcc

c_compiler_version:
  - if: linux
    then:
      - 13
  - if: osx
    then:
      - 17
  - if: not unix
    then:
      - 14

c_stdlib:
  - if: not unix
    then:
      - m2w64-sysroot

c_stdlib_version:
  - if: linux
    then:
      - 2.17
  - if: osx and x86_64
    then:
      - 11.0
  - if: osx and arm64
    then:
      - 11.0
  - if: not unix
    then:
      - 12

# Cross-compiler variants (zipped together for consistency)
# These are used by Output 3 (ocaml-cross-compiler_${cross_target})
zip_keys:
  - - cross_build
    - cross_target
    - cross_linker
    - triplet_target

cross_build:
  - linux-64      # Builds aarch64 cross-compiler
  - linux-64      # Builds ppc64le cross-compiler
  - osx-64        # Builds arm64 cross-compiler

cross_target:
  - linux-aarch64
  - linux-ppc64le
  - osx-arm64

cross_linker:
  - ld-linux-aarch64.so.1
  - ld64.so.2
  - "-"

triplet_target:
  - aarch64-conda-linux-gnu
  - powerpc64le-conda-linux-gnu
  - arm64-apple-darwin20.0.0
