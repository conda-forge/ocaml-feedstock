--- a/Makefile
+++ b/Makefile
@@ -139,6 +139,18 @@ RES=version_res.o
 RES_PREFIX=
 endif

+# For mingw toolchains, always use simple LINKFLAGS without -link
+# The -link flag is flexlink-specific, but during flexlink bootstrap
+# gcc is used directly which doesn't understand -link
+#
+# Also link flexdll_mingw64.o which provides the flexdll API implementation
+# (flexdll_wdlopen, flexdll_dlclose, etc.) needed by libasmrun.a
+ifneq ($(filter mingw mingw64,$(TOOLCHAIN)),)
+LINKFLAGS = -cclib "$(RES)" -cclib flexdll_$(TOOLCHAIN).o
+# Ensure support object is built before flexlink.exe
+flexlink.exe: flexdll_$(TOOLCHAIN).o
+else
+
 ifeq ($(NATDYNLINK), false)
 #when ocaml is not built with flexlink i.e. -no-shared-libs
 LINKFLAGS = -cclib "$(RES)"
@@ -146,6 +158,7 @@ else
 LINKFLAGS = -cclib "-link $(RES)"
 endif

+endif
 support: $(addprefix build_, $(CHAINS))

